---
layout: post
title: OverlayFS - CVE-2021-3493
date: 2024-07-07 13:00:00 +0000
categories: [CTF, TryHackMe]
tags: [ctf, tryhackme, blog]
excerpt: "This is the excerpt of CTF 1."
image: /assets/img/logo/hacker-mask-logo.jpg
---

# OverlayFS - CVE-2021-3493

---

> Exploit a 2021 Kernel vulnerability in Ubuntu to become root almost instantly!
> 

- `OverlayFS` is a Linux kernel module that allows the system to combine several mount points into one, so that you can access all the files from each within one directory structure.
- It's often used by live USBs, or some other specialist applications. One use is having a read only root file system, and another partition "overlayed" with that to allow applications to write to a temporary file system.
- More resources are included in the final task (Further reading) if you'd like to learn more about OverlayFS and this exploit.

---

> `*SSD*` provides the knowledge, experience and tools needed to find and *disclose* vulnerabilities and advanced attack vectors.
> 

### About the vuln

- Recently, SSD-Disclosure released a proof of concept (and a great explanation) for an Ubuntu kernel exploit ([https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/](https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/)).
- This vulnerability is particularly serious, as overlayfs is a kernel module that is installed by default on Ubuntu 1804 Server.
- If the system is vulnerable, you can very easily escalate from any user to root, as long as you can run a binary.
- If there isn't a C compiler installed on the machine, you can compile the binary statically elsewhere and copy just the binary over.

### Credentials for SSH

```powershell
Username: **overlay**

Password: **tryhackme123**
```

---

- Get shell using Using given ssh credentials

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled.png)

- Download exploit from [https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/](https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/) and compile it.

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled%201.png)

- Copy compiled file into target machine

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled%202.png)

- Run on target machine to gain root privileges

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled%203.png)

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled%204.png)

- Finally get flag at /root/flag.txt

![Untitled](/assets/img/blog/tryhackme/ctf/easy/OverlayFS%20-%20CVE-2021-3493%2099a25ef296fe47d29c025419fbae6381/Untitled%205.png)